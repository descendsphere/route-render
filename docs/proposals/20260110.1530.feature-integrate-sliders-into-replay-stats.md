# Design Proposal: Integrate Sliders into Replay Stats Panel

- **ID:** `20260110.1530.feature-integrate-sliders-into-replay-stats`
- **Status:** Proposed
- **Author:** Gemini
- **Date:** 2026-01-10

## 1. Summary

This document proposes a significant UI refactoring to relocate the tour control sliders (Speed, Zoom, Pitch) from the main side panel into the "Replay Stats" panel. This change enhances contextual usability by grouping all active tour controls together, making them visible only during tour playback.

This design supersedes the previous backlog item `[REFACTOR] Horizontal Quick Controls`.

## 2. Problem

Currently, the Speed, Zoom (Distance), and Pitch sliders are always visible in the main side panel. When the panel is collapsed, they move to a vertical "quick-controls" bar on the left. This implementation has two main drawbacks:
1.  The controls are disconnected from the primary tour playback context (the bottom control bar and stats panels).
2.  The vertical sliders are not ideal for touch-based interaction.

## 3. Proposed Solution

### 3.1. Architectural Design

The core of this design is to treat the sliders as dynamic UI components that are physically moved within the DOM based on the application's state.

-   **"Home" Location:** The sliders' markup will remain in `index.html` inside the main side panel. This is their default state.
-   **"Touring" Location:** When a tour begins, the "Replay Stats" panel is created. The sliders will be programmatically moved from the side panel and appended to a new section within the "Replay Stats" panel.
-   **Lifecycle Management:** The `UIManager` module will manage this lifecycle. When the tour stops and the "Replay Stats" panel is destroyed, the `UIManager` will move the sliders back to their original "home" location in the side panel.

This "move, don't duplicate" approach is highly efficient as it preserves the DOM elements and any attached event listeners, avoiding complex re-initialization.

### 3.2. Implementation Details

1.  **`UIManager.js` Modifications:**
    -   The method that creates and displays the `Replay Stats` panel will be updated.
    -   **On Tour Start:**
        1.  Create a new container: `<div class="replay-stats-sliders"></div>`.
        2.  Append this new `div` to the content area of the `Replay Stats` panel.
        3.  Before showing the panel, identify the three `.slider-group` elements for Speed, Distance, and Pitch within the main side panel.
        4.  Use `appendChild()` to move these elements into the `.replay-stats-sliders` container.
    -   **On Tour Stop:**
        1.  The method that hides or destroys the `Replay Stats` panel will be updated.
        2.  It will move the three `.slider-group` elements from the `.replay-stats-sliders` container back to their original parent `div`s inside the main side panel.

2.  **`style.css` Modifications:**
    -   All CSS rules for the now-obsolete `#quick-controls-container` and `.vertical-slider` will be removed.
    -   New CSS rules will be added:
        -   `.replay-stats-sliders`: Will be styled with `display: flex`, `justify-content: space-between`, and `gap: 10px` to create a horizontal row.
        -   `.replay-stats-sliders .slider-group`: Will be styled with `flex: 1` to ensure they share the container width equally. The inner layout will be adjusted for a clean horizontal appearance (icon, slider, value).
        -   `.replay-stats-sliders input[type=range]`: Will be styled to take up the majority of the width within its group.

3.  **`index.html` Modifications:**
    -   The empty and now-obsolete `<div id="quick-controls-container"></div>` will be removed from the markup.

This solution provides a more intuitive, context-aware, and mobile-friendly user experience for controlling the tour.